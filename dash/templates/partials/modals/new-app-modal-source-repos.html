<div class="col" hx-get="/html/modal/app/repos" hx-swap="outerHTML"
  hx-target="change from:#accounts-form">
  <div class="mb-3">
    <label class="form-label">Select with avatars</label>
    <select name="repo" type="text" class="form-select" id="select-source-repo" value="">
      {% for repo in repos %}
      <option value="{{ repo }}">{{ repo }}</option>
      {% endfor %}
    </select>
  </div>
</div>
<script>
  // @formatter:off
  var func = function () {
  	var el;
  	window.TomSelect && (new TomSelect(el = document.getElementById('select-source-repo'), {
  		copyClassesToDropdown: false,
  		dropdownParent: 'body',
  		controlInput: '<input>',
  		render:{
  			item: function(data,escape) {
  				if( data.customProperties ){
  					return '<div><span class="dropdown-item-indicator">' + data.customProperties + '</span>' + escape(data.text) + '</div>';
  				}
  				return '<div>' + escape(data.text) + '</div>';
  			},
  			option: function(data,escape){
  				if( data.customProperties ){
  					return '<div><span class="dropdown-item-indicator">' + data.customProperties + '</span>' + escape(data.text) + '</div>';
  				}
  				return '<div>' + escape(data.text) + '</div>';
  			},
  		},
  	}));
  };
  document.addEventListener("DOMContentLoaded", func);
  document.addEventListener("htmx:afterSettle", func);
  // @formatter:on
</script>
